"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{3:(i,t,s)=>{s.r(t),s.d(t,{CursorCoordinator:()=>o});var e=s(3147),n=class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}subscribe(i){if((0,e.b)())return()=>{};let t={subscription:i,lastCallTime:0,timeoutId:null};return this.subscribers.set(i.id,t),this.isListening||this.startListening(),this.currentPosition&&setTimeout(()=>{this.subscribers.has(i.id)&&this.callSubscriber(t)},0),()=>{this.unsubscribe(i.id)}}unsubscribe(i){let t=this.subscribers.get(i);null!=t&&t.timeoutId&&clearTimeout(t.timeoutId),this.subscribers.delete(i),0===this.subscribers.size&&this.stopListening()}startListening(){this.isListening||(0,e.b)()||(document.addEventListener("mousemove",this.handleMouseMove),this.isListening=!0,this.loadGlobalPosition())}stopListening(){this.isListening&&(document.removeEventListener("mousemove",this.handleMouseMove),this.isListening=!1,this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null))}handleMouseMove(i){let t={x:i.clientX,y:i.clientY};this.currentPosition=t,this.saveGlobalPosition(),null===this.rafId&&(this.rafId=requestAnimationFrame(()=>{this.notifySubscribers(),this.rafId=null}))}notifySubscribers(){if(!this.currentPosition)return;let i=Date.now();this.subscribers.forEach(t=>{let{subscription:s,lastCallTime:e,timeoutId:n}=t,{throttleMs:r=0}=s;if(r>0){let s=i-e;s>=r?this.callSubscriber(t):(n&&clearTimeout(n),t.timeoutId=setTimeout(()=>{this.callSubscriber(t),t.timeoutId=null},r-s))}else this.callSubscriber(t)})}callSubscriber(i){this.currentPosition&&(i.subscription.callback(this.currentPosition),i.lastCallTime=Date.now())}loadGlobalPosition(){try{let i=window.__mouseTrackerPosition__;i&&"number"==typeof i.x&&"number"==typeof i.y&&(this.currentPosition=i)}catch(i){}}saveGlobalPosition(){if(this.currentPosition)try{window.__mouseTrackerPosition__=(0,e.a)({},this.currentPosition)}catch(i){}}getCurrentPosition(){return this.currentPosition?(0,e.a)({},this.currentPosition):null}getSubscriberCount(){return this.subscribers.size}static resetInstance(){i.instance&&(i.instance.stopListening(),i.instance=null)}constructor(){this.subscribers=new Map,this.currentPosition=null,this.isListening=!1,this.rafId=null,this.handleMouseMove=this.handleMouseMove.bind(this)}};n.instance=null;var r=class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}subscribe(i){if((0,e.b)())return()=>{};this.subscribers.set(i.id,{subscription:i,lastCallTime:0,timeoutId:null}),this.isListening||this.startListening();let t=this.mouseTracker.subscribe({id:"coordinator-".concat(i.id),callback:t=>{this.updateGlobalPosition(t),this.notifyPositionChange(i.id,t)},throttleMs:i.throttleMs});return()=>{t(),this.unsubscribe(i.id)}}unsubscribe(i){let t=this.subscribers.get(i);null!=t&&t.timeoutId&&clearTimeout(t.timeoutId),this.subscribers.delete(i),0===this.subscribers.size&&this.stopListening()}startListening(){this.isListening||(0,e.b)()||(document.addEventListener("scroll",this.handleLayoutChange,!0),window.addEventListener("resize",this.handleLayoutChange),this.isListening=!0)}stopListening(){this.isListening&&(document.removeEventListener("scroll",this.handleLayoutChange,!0),window.removeEventListener("resize",this.handleLayoutChange),this.isListening=!1,this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null))}handleLayoutChange(){null===this.rafId&&(this.rafId=requestAnimationFrame(()=>{this.notifyAllSubscribersWithCurrentPosition(),this.rafId=null}))}updateGlobalPosition(i){this.currentGlobalPosition=i}notifyPositionChange(i,t){let s=this.subscribers.get(i);s&&s.subscription.onPositionChange(t)}notifyAllSubscribersWithCurrentPosition(){this.currentGlobalPosition&&this.subscribers.forEach(i=>{i.subscription.onPositionChange(this.currentGlobalPosition)})}getSubscriberCount(){return this.subscribers.size}static resetInstance(){i.instance&&(i.instance.stopListening(),i.instance=null)}constructor(){this.subscribers=new Map,this.currentGlobalPosition=null,this.isListening=!1,this.rafId=null,this.mouseTracker=n.getInstance(),this.handleLayoutChange=this.handleLayoutChange.bind(this)}};r.instance=null;var o=r}}]);